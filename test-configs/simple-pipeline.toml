# Generated by lv-py - Logstash to Vector Migration Tool
# Source: ../test-configs/simple-pipeline.toml

["sources.file_input_0"]
type = "file"
include = ["/var/log/app.log"]
read_from = "beginning"

["transforms.grok_filter_0"]
type = "remap"
inputs = ["file_input_0"]
source = ". = parse_groks!(.message, ['%{COMBINEDAPACHELOG}'])"

["transforms.mutate_filter_1"]
type = "remap"
inputs = ["grok_filter_0"]
source = "del(.temp)"

["transforms.date_filter_2"]
type = "remap"
inputs = ["mutate_filter_1"]
source = ".@timestamp = parse_timestamp!(.timestamp, format: \"%+\")"

# TODO: Convert Logstash index template 'logs-%{+YYYY.MM.dd}' to Vector format

["sinks.elasticsearch_output_0"]
type = "elasticsearch"
inputs = ["date_filter_2"]
endpoints = ["http://localhost:9200"]
mode = "bulk"
index = "logs"

["sinks.file_output_1"]
type = "file"
inputs = ["date_filter_2"]
path = "/var/log/output.log"

["sinks.file_output_1".encoding]
codec = "json"

