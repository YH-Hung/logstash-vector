# Generated by lv-go - Logstash to Vector Migration Tool
# Source: testdata/logstash/simple-pipeline.conf

[sources.file_source_0]
type = "file"
include = ["/var/log/app.log"]
read_from = "beginning"

[transforms.grok_transform_0]
type = "remap"
inputs = ["file_source_0"]
source = ". = parse_groks!(.message, [\"%{COMBINEDAPACHELOG}\"])"

[transforms.mutate_transform_1]
type = "remap"
inputs = ["grok_transform_0"]
source = "del(.temp)"

[transforms.date_transform_2]
type = "remap"
inputs = ["mutate_transform_1"]
source = ".@timestamp = parse_timestamp!(.timestamp, format: \"%+\")"

# TODO: Convert Logstash index template 'logs-%{+YYYY.MM.dd}' to Vector format
[sinks.elasticsearch_sink_0]
type = "elasticsearch"
inputs = ["date_transform_2"]
index = "logs"
endpoints = ["http://localhost:9200"]
mode = "bulk"

[sinks.file_sink_1]
type = "file"
inputs = ["date_transform_2"]
path = "/var/log/output.log"
encoding = { codec = "json" }

